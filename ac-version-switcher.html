<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Versions</title>
<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #1e1e2f;
        color: #e0e0e0;
        padding: 20px;
    }
    h1, h2, h3 {
        color: #a259ff;
    }
    button {
        background-color: #a259ff;
        color: #fff;
        border: none;
        padding: 10px 15px;
        margin: 5px 0;
        border-radius: 5px;
        cursor: pointer;
    }
    button:hover {
        background-color: #8b3ddb;
    }
    .update, .hotfix {
        background-color: #2a2a3d;
        padding: 15px;
        margin-bottom: 15px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    .hotfix {
        background-color: #3a3a5d;
    }
    ul {
        margin: 10px 0 10px 20px;
    }
    .date {
        font-size: 0.9em;
        color: #ccc;
    }
    .hidden {
        display: none;
    }
</style>
</head>
<body>

<h1>Game Versions</h1>

<div id="versionList"></div>
<div id="versionPage" class="hidden">
    <button id="backBtn">⬅ Back to Versions</button>
    <div id="versionContent"></div>
    <button id="hotfixBtn" class="hidden">Show Hotfixes</button>
    <div id="hotfixContent" class="hidden"></div>
</div>

<script>
const jsonURL = "https://wa1do.pythonanywhere.com/raw/wa1dowebsites/wa1do.pythonanywhere.com/refs/heads/main/game_data.json";
let gameData = {};

async function fetchData() {
    try {
        const res = await fetch(jsonURL);
        gameData = await res.json();
        renderVersionList();
    } catch(err) {
        document.getElementById('versionList').innerHTML = "Failed to load versions.";
        console.error(err);
    }
}

// Show main version list
function renderVersionList() {
    const listDiv = document.getElementById('versionList');
    listDiv.innerHTML = "";
    for (const verKey in gameData) {
        const ver = gameData[verKey];
        const btn = document.createElement('button');
        btn.textContent = `${verKey} - ${ver.NAME || ''}`;
        btn.addEventListener('click', () => openVersion(verKey));
        listDiv.appendChild(btn);
    }
}

// Open a version “page”
function openVersion(verKey) {
    const version = gameData[verKey];
    document.getElementById('versionList').classList.add('hidden');
    const versionPage = document.getElementById('versionPage');
    versionPage.classList.remove('hidden');

    const contentDiv = document.getElementById('versionContent');
    contentDiv.innerHTML = `
        <h2>${verKey} - ${version.NAME}</h2>
        <p class="date">Release Date: ${version.DATE}</p>
        <p>Binary ID: ${version.BINARY_ID || ''} | Version Code: ${version.VERSION_CODE || ''}</p>
        <h3>Features:</h3>
        <ul>${version.FEATURES.map(f => `<li>${f}</li>`).join("")}</ul>
    `;

    const hotfixBtn = document.getElementById('hotfixBtn');
    const hotfixContent = document.getElementById('hotfixContent');
    if (version.HOTFIX) {
        hotfixBtn.classList.remove('hidden');
        hotfixContent.classList.add('hidden');
        hotfixContent.innerHTML = "";
        hotfixBtn.onclick = () => {
            hotfixContent.innerHTML = "";
            for (const hfKey in version.HOTFIX) {
                const hf = version.HOTFIX[hfKey];
                const div = document.createElement('div');
                div.classList.add('hotfix');
                div.innerHTML = `
                    <h4>${hfKey}</h4>
                    <p class="date">Date: ${hf.DATE}</p>
                    <p>Binary ID: ${hf.BINARY_ID || ''} | Version Code: ${hf.VERSION_CODE || ''}</p>
                    <ul>${hf.FEATURES.map(f => `<li>${f}</li>`).join("")}</ul>
                `;
                hotfixContent.appendChild(div);
            }
            hotfixContent.classList.remove('hidden');
        };
    } else {
        hotfixBtn.classList.add('hidden');
        hotfixContent.classList.add('hidden');
    }
}

// Back button
document.getElementById('backBtn').addEventListener('click', () => {
    document.getElementById('versionPage').classList.add('hidden');
    document.getElementById('versionList').classList.remove('hidden');
});

fetchData();
</script>
</body>
</html>
